import vcr

from pycomponents.osv import OSV
from pycomponents.vulnerability import VulnerabilityFactory


@vcr.use_cassette("tests/fixtures/vcr_cassettes/osv_jinja2_2.4.1.yaml")
def test_from_osv_vuln():
    osv = OSV()
    res = osv.query(name="jinja2", version="2.4.1")
    for vuln in res.vulns:
        vulnerability = VulnerabilityFactory.from_osv_vuln(vuln)
        assert vulnerability.id == vuln.id
